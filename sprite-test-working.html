<!DOCTYPE html>
<html>
<head>
    <title>Sprite Test - Server Running</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background: #1a1a1a; 
            color: white; 
            padding: 20px; 
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        .test-section {
            background: #333;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        canvas { 
            border: 2px solid #666; 
            margin: 10px; 
            image-rendering: pixelated;
            background: #000;
        }
        .result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success { background: #2d5a2d; }
        .error { background: #5a2d2d; }
        .info { background: #2d4a5a; }
        button {
            background: #4a9eff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #3a8eef;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ Sprite Test - Server Running!</h1>
        
        <div class="test-section">
            <h3>‚úÖ Server Status</h3>
            <div id="server-status" class="result info">
                üîÑ Testing server connection...
            </div>
        </div>
        
        <div class="test-section">
            <h3>üé¨ Sprite Tests</h3>
            <div class="sprite-tests">
                <div>
                    <h4>Static Sprite (anime-clean.png):</h4>
                    <canvas id="static-canvas" width="32" height="64"></canvas>
                    <div id="static-result" class="result info">Loading...</div>
                </div>
                
                <div>
                    <h4>Animation Sprite (anime-walk.png):</h4>
                    <canvas id="anim-canvas" width="32" height="64"></canvas>
                    <div id="anim-result" class="result info">Loading...</div>
                </div>
            </div>
        </div>
        
        <div class="test-section">
            <h3>üéØ Game Test</h3>
            <div class="result info">
                <strong>Now test the actual game:</strong><br>
                1. Open <a href="http://localhost:5173" target="_blank" style="color: #4a9eff;">http://localhost:5173</a><br>
                2. Make sure you're on the HOME screen<br>
                3. Click to move the character<br>
                4. Check browser console (F12) for debug messages
            </div>
        </div>
        
        <div class="test-section">
            <h3>üîç Debug Console</h3>
            <div id="console-output" class="result info">
                Open browser DevTools (F12) ‚Üí Console tab to see debug messages
            </div>
        </div>
    </div>
    
    <script>
        // Test server connection
        fetch('/package.json')
            .then(response => {
                if (response.ok) {
                    document.getElementById('server-status').innerHTML = 
                        '‚úÖ Development server is running!<br>‚úÖ Can access project files';
                    document.getElementById('server-status').className = 'result success';
                }
            })
            .catch(error => {
                document.getElementById('server-status').innerHTML = 
                    '‚ùå Server connection failed<br>Make sure npm run dev is running';
                document.getElementById('server-status').className = 'result error';
            });
        
        // Test static sprite
        const staticCanvas = document.getElementById('static-canvas');
        const staticCtx = staticCanvas.getContext('2d');
        staticCtx.imageSmoothingEnabled = false;
        
        const staticImg = new Image();
        staticImg.onload = () => {
            document.getElementById('static-result').innerHTML = 
                `‚úÖ Loaded: ${staticImg.width}√ó${staticImg.height}`;
            document.getElementById('static-result').className = 'result success';
            staticCtx.drawImage(staticImg, 0, 0, 32, 64);
            console.log('‚úÖ Static sprite loaded:', staticImg.width, 'x', staticImg.height);
        };
        staticImg.onerror = () => {
            document.getElementById('static-result').innerHTML = 
                '‚ùå Failed to load anime-clean.png';
            document.getElementById('static-result').className = 'result error';
            console.error('‚ùå Failed to load anime-clean.png');
        };
        staticImg.src = '/assets/sprites/anime-clean.png';
        
        // Test animation sprite
        const animCanvas = document.getElementById('anim-canvas');
        const animCtx = animCanvas.getContext('2d');
        animCtx.imageSmoothingEnabled = false;
        
        const animImg = new Image();
        animImg.onload = () => {
            document.getElementById('anim-result').innerHTML = 
                `‚úÖ Loaded: ${animImg.width}√ó${animImg.height}`;
            document.getElementById('anim-result').className = 'result success';
            console.log('‚úÖ Animation sprite loaded:', animImg.width, 'x', animImg.height);
            
            // Test if it's the right size for 4 frames
            if (animImg.width === 128 && animImg.height === 64) {
                console.log('‚úÖ Correct dimensions for 4-frame animation');
                animateSprite(animImg);
            } else {
                console.warn('‚ö†Ô∏è Wrong dimensions. Expected 128√ó64, got', animImg.width, 'x', animImg.height);
                document.getElementById('anim-result').innerHTML += 
                    '<br>‚ö†Ô∏è Wrong dimensions for 4-frame animation';
            }
        };
        animImg.onerror = () => {
            document.getElementById('anim-result').innerHTML = 
                '‚ùå Failed to load anime-walk.png';
            document.getElementById('anim-result').className = 'result error';
            console.error('‚ùå Failed to load anime-walk.png');
        };
        animImg.src = '/assets/sprites/anime-walk.png';
        
        function animateSprite(img) {
            let frame = 0;
            const FRAME_WIDTH = 32;
            const FRAME_HEIGHT = 64;
            const FPS = 8;
            let lastTime = performance.now();
            
            function animate(now) {
                const dt = (now - lastTime) / 1000;
                lastTime = now;
                
                const frameTime = 1 / FPS;
                if (dt >= frameTime) {
                    frame = (frame + 1) % 4;
                }
                
                // Clear and draw current frame
                animCtx.clearRect(0, 0, 32, 64);
                const sourceX = frame * FRAME_WIDTH;
                animCtx.drawImage(
                    img,
                    sourceX, 0, FRAME_WIDTH, FRAME_HEIGHT,
                    0, 0, FRAME_WIDTH, FRAME_HEIGHT
                );
                
                requestAnimationFrame(animate);
            }
            
            animate(performance.now());
            console.log('üé¨ Animation started');
        }
        
        // Log to console for debugging
        console.log('üéÆ Sprite test page loaded');
        console.log('üîç Testing sprite loading...');
    </script>
</body>
</html>
